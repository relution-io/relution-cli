"use strict";
var Archiver_1 = require('./Archiver');
var rxjs_1 = require('@reactivex/rxjs');
var RxFs_1 = require('./RxFs');
var path = require('path');
var chalk = require('chalk');
var figures = require('figures');
var Create_1 = require('./../commands/project/Create');
var expect = require('expect.js');
describe('Utility Archiver', function () {
    var commandCreate;
    var commandRoot = path.join(process.cwd(), 'spec', 'gentest', 'archiver');
    var archiver = new Archiver_1.Archiver(commandRoot);
    before(function () {
        commandCreate = new Create_1.Create();
        commandCreate.npmInstall = function () {
            return rxjs_1.Observable.empty();
        };
        commandCreate.rootProjectFolder = commandRoot;
        return RxFs_1.RxFs.mkdir(commandRoot).toPromise().then(function () {
            expect(RxFs_1.RxFs.exist(commandRoot)).to.be(true);
            return commandCreate.publish('test', true).toPromise();
        });
    });
    it('read files from without ignore', function (done) {
        archiver.createBundle().subscribe(function (log) {
            if (log.file || log.directory) {
                console.log(chalk.magenta(log.file ? "add file " + log.file : "add directory " + log.directory));
            }
            else if (log.zip) {
                console.log(chalk.green(log.message) + ' ' + figures.tick);
                expect(RxFs_1.RxFs.exist(log.zip)).to.be(true);
                done();
            }
            else if (log.processed) {
                console.log(chalk.green(log.processed) + ' ' + figures.tick);
            }
        });
    });
    after(function () {
        return RxFs_1.RxFs.rmDir(commandRoot).toPromise();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXJjaGl2ZXIuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXR5L0FyY2hpdmVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHlCQUF1QixZQUFZLENBQUMsQ0FBQTtBQUNwQyxxQkFBeUIsaUJBQWlCLENBQUMsQ0FBQTtBQUMzQyxxQkFBbUIsUUFBUSxDQUFDLENBQUE7QUFDNUIsSUFBWSxJQUFJLFdBQU0sTUFBTSxDQUFDLENBQUE7QUFDN0IsSUFBWSxLQUFLLFdBQU0sT0FBTyxDQUFDLENBQUE7QUFDL0IsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBRW5DLHVCQUFxQiw4QkFBOEIsQ0FBQyxDQUFBO0FBQ3BELElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUVwQyxRQUFRLENBQUMsa0JBQWtCLEVBQUU7SUFDM0IsSUFBSSxhQUFxQixDQUFDO0lBQzFCLElBQUksV0FBVyxHQUFXLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDbEYsSUFBSSxRQUFRLEdBQWEsSUFBSSxtQkFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBRW5ELE1BQU0sQ0FBQztRQUNMLGFBQWEsR0FBRyxJQUFJLGVBQU0sRUFBRSxDQUFDO1FBQzdCLGFBQWEsQ0FBQyxVQUFVLEdBQUc7WUFDekIsTUFBTSxDQUFDLGlCQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDNUIsQ0FBQyxDQUFDO1FBQ0YsYUFBYSxDQUFDLGlCQUFpQixHQUFHLFdBQVcsQ0FBQztRQUM5QyxNQUFNLENBQUMsV0FBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDOUMsTUFBTSxDQUFDLFdBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUN6RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLFVBQUMsSUFBSTtRQUN4QyxRQUFRLENBQUMsWUFBWSxFQUFFLENBQUMsU0FBUyxDQUMvQixVQUFDLEdBQVE7WUFDUCxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUM5QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksR0FBRyxjQUFZLEdBQUcsQ0FBQyxJQUFNLEdBQUcsbUJBQWlCLEdBQUcsQ0FBQyxTQUFXLENBQUMsQ0FBQyxDQUFDO1lBQ25HLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7Z0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDM0QsTUFBTSxDQUFDLFdBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDeEMsSUFBSSxFQUFFLENBQUM7WUFDVCxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUN6QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0QsQ0FBQztRQUNILENBQUMsQ0FDRixDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFFSCxLQUFLLENBQUM7UUFDSixNQUFNLENBQUMsV0FBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUM3QyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIn0=